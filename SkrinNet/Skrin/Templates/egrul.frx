<?xml version="1.0" encoding="utf-8"?>
<Report ScriptLanguage="CSharp" ReportInfo.Created="03/16/2017 14:06:28" ReportInfo.Modified="03/27/2017 10:04:58" ReportInfo.CreatorVersion="2015.1.1.0">
  <ScriptText>using System;
using System.Collections;
using System.Collections.Generic;
using System.ComponentModel;
using System.Windows.Forms;
using System.Drawing;
using System.Data;
using FastReport;
using FastReport.Data;
using FastReport.Dialog;
using FastReport.Barcode;
using FastReport.Table;
using FastReport.Utils;

namespace FastReport
{
  public class ReportScript
  {

    private void EgrulTable_ManualBuild(object sender, EventArgs e)
    {
      DataSourceBase rowData = Report.GetDataSource(&quot;EgrulRows&quot;);
      // инициализируем его
      rowData.Init();
      // печатаем заголовоки таблицы
      EgrulTable.PrintRow(0);
      EgrulTable.PrintColumns();
      EgrulTable.PrintRow(1);
      EgrulTable.PrintColumns();
      // выполняем цикл, пока в источнике данных есть записи
      while (rowData.HasMoreRows)
      {
        bool IsHeaderRow = (bool)Report.GetColumnValue(&quot;EgrulRows.IsHeaderRow&quot;);
        if(IsHeaderRow){
           EgrulTable.PrintRow(2);   
        }else{
           EgrulTable.PrintRow(3);
        }
        
        EgrulTable.PrintColumns();
        // печатаем строку таблицы
        
        // переходим на следующую запись источника
        rowData.Next();
      } 
      // печатаем подвал таблицы
      
    }
  }
}
</ScriptText>
  <Dictionary>
    <BusinessObjectDataSource Name="CoreInfo" ReferenceName="CoreInfo" DataType="null" Enabled="true">
      <Column Name="ogrn" DataType="System.String"/>
      <Column Name="inn" DataType="System.String"/>
      <Column Name="kpp" DataType="System.String"/>
      <Column Name="name" DataType="System.String"/>
      <Column Name="update_date" DataType="System.String"/>
    </BusinessObjectDataSource>
    <BusinessObjectDataSource Name="EgrulRows" ReferenceName="EgrulRows" DataType="null" Enabled="true">
      <Column Name="IsHeaderRow" DataType="System.Boolean"/>
      <Column Name="Id" DataType="System.Int32"/>
      <Column Name="Header" DataType="System.String"/>
      <Column Name="Value" DataType="System.String"/>
      <Column Name="SuperHeader" DataType="System.String"/>
    </BusinessObjectDataSource>
  </Dictionary>
  <ReportPage Name="Page1">
    <ReportTitleBand Name="ReportTitle1" Width="718.2" Height="85.05">
      <TextObject Name="Text1" Left="18.9" Top="37.8" Width="670.95" Height="18.9" Text="Сведения о юридическом лице" HorzAlign="Center"/>
      <TextObject Name="Text3" Left="18.9" Top="9.45" Width="670.95" Height="18.9" Text="ЕДИНЫЙ ГОСУДАРСТВЕННЫЙ РЕЕСТР ЮРИДИЧЕСКИХ ЛИЦ" HorzAlign="Center"/>
    </ReportTitleBand>
    <DataBand Name="Data1" Top="89.05" Width="718.2" Height="94.5" DataSource="CoreInfo" MaxRows="1">
      <TextObject Name="Text4" Left="18.9" Width="670.95" Height="28.35" CanGrow="true" CanShrink="true" GrowToBottom="true" Text="[CoreInfo.name]" HorzAlign="Center"/>
      <TextObject Name="Text5" Left="18.9" Top="37.8" Width="264.6" Height="47.25" Text="ОГРН [CoreInfo.ogrn]&#13;&#10;ИНН/КПП [CoreInfo.inn]/[CoreInfo.kpp]&#13;&#10;по состоянию на [CoreInfo.update_date]"/>
    </DataBand>
    <DataBand Name="Data2" Top="187.55" Width="718.2" Height="103.95" DataSource="EgrulRows" MaxRows="1">
      <TableObject Name="EgrulTable" Left="9.45" Top="9.45" Width="667.17" Height="75.6" Border.Lines="All" ManualBuildEvent="EgrulTable_ManualBuild">
        <TableColumn Name="Column1" Width="58.59"/>
        <TableColumn Name="Column2" Width="304.29"/>
        <TableColumn Name="Column3" Width="304.29"/>
        <TableRow Name="Row1">
          <TableCell Name="Cell1" Border.Lines="All" Text="№ п/п" HorzAlign="Center"/>
          <TableCell Name="Cell2" Border.Lines="All" Text="Наименование показателя" HorzAlign="Center"/>
          <TableCell Name="Cell3" Border.Lines="All" Text="Значение показателя" HorzAlign="Center"/>
        </TableRow>
        <TableRow Name="Row2">
          <TableCell Name="Cell6" Text="1" HorzAlign="Center"/>
          <TableCell Name="Cell7" Border.Lines="All" Text="2" HorzAlign="Center"/>
          <TableCell Name="Cell8" Border.Lines="All" Text="3" HorzAlign="Center"/>
        </TableRow>
        <TableRow Name="Row3" AutoSize="true">
          <TableCell Name="CellNo" Border.Lines="All" Text="[EgrulRows.Header]" HorzAlign="Center" HtmlTags="true" ColSpan="3"/>
          <TableCell Name="Cell12"/>
          <TableCell Name="Cell13"/>
        </TableRow>
        <TableRow Name="Row4" AutoSize="true">
          <TableCell Name="Cell14" Border.Lines="All" Text="[EgrulRows.Id]" HorzAlign="Center"/>
          <TableCell Name="Cell15" Border.Lines="All" Text="[EgrulRows.Header]" HtmlTags="true"/>
          <TableCell Name="Cell16" Border.Lines="All" Text="[EgrulRows.Value]" HtmlTags="true"/>
        </TableRow>
      </TableObject>
      <DataFooterBand Name="DataFooter1" Top="295.5" Width="718.2" Height="103.95">
        <TextObject Name="Text6" Left="9.45" Top="9.45" Width="670.95" Height="85.05" Text="&lt;b&gt;Примечание:&lt;/b&gt; При формировании документа используются  сведения о ЮЛ, внесенные в базу ЕГРЮЛ МИ ФНС по ЦОД&#13;&#10;&#13;&#10;ВНИМАНИЕ: в связи с особенностями функционирования и обновления указанного источника информации АО 'СКРИН' не может гарантировать абсолютную актуальность и достоверность данных." HtmlTags="true"/>
      </DataFooterBand>
    </DataBand>
    <PageFooterBand Name="PageFooter1" Top="403.45" Width="718.2" Height="37.8">
      <TextObject Name="Text7" Left="9.45" Top="9.45" Width="689.85" Height="18.9" Text="ОГРН: [CoreInfo.ogrn]" HorzAlign="Center" Font="Arial, 8.25pt"/>
      <TextObject Name="Text2" Left="472.5" Top="9.45" Width="226.8" Height="18.9" Text="Страница [Page#] из [TotalPages#]" HorzAlign="Right" Font="Arial, 8pt"/>
    </PageFooterBand>
  </ReportPage>
</Report>
