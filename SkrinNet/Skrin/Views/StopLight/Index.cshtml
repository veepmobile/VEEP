@model StopLightData
@using Skrin.BLL.Iss
@using serch_contra_bll.StopLightFreeEgrul

@{
    Layout = null;
}
@{ int i = 1;}
<div id="stoplight_inner" data-show="@ViewBag.CanShowStopLight">
    <h5>Уровень надежности</h5>
    <div class="sl_chart" id="sl" data-count="@ViewBag.factors_count" data-color="@Model.Rating"></div>
    <a class="sl_more" href="#">Протокол проверки...</a>
</div>
@if (ViewBag.CanShowStopLight && Model.Factors!=null)
{
    <div id="stoplight_content">
        <style>
            #protocol_box .profile_table {
                float: none;
            }
        </style>

        <div id="protocol_box">
            <h1>@StopLightUtilites.GetHeader(Model)</h1>
            <h2>Безусловный стоп-сигнал</h2>
            <div style="width: 949px;" class="thead">
                <div style="width: 350px; padding-left: 20px;" class="th">Параметр</div>
                <div style="padding-left: 20px; border-right: none" class="th">Информация</div>
            </div>
            <div style="width: 951px;" class="tline"></div>
            @foreach (var factor in Model.Factors.Where(p => p.Value.IsUnconditional))
            {
                <div id="tbla@(i)" class="srclist_tbl" onclick="StopLight.switch_rating_info(this);StopLight.show_rating_info('a@(i)');" style="">
                    <div class="tabtr" style="width: 350px; padding-left: 20px;">
                        @if (factor.Value.IsStoped)
                        {
                            <span class="title">
                                <em style="font-weight:normal;">@factor.Value.Info</em>
                                <span class="icon-attention-circled red_attention"></span>
                            </span>
                        }
                        @factor.Value.Name
                    </div>
                    <div class="tabtr" style="width: 400px; padding-left: 20px;">@factor.Value.Info</div>
                    <div class="tabtr">
                        @if (StopLightUtilites.HasInfo(Model, factor.Key))
                        {
                            <span class="icon-angle-down" style="cursor: pointer">Подробнее</span>
                        }
                    </div>
                </div>
                if (StopLightUtilites.HasInfo(Model, factor.Key))
                {
                    <div id="tbla@(i)_info" class="sub_srclist_tbl" style="display: none;">
                        @Html.Action("ShowInfo", new
                {
                    data = Model,
                    factor = factor.Key

                })
                    </div>
                }
                i++;
            }
            <div style="clear: both;"></div>
            <h2>Условный стоп-сигнал</h2>
            <div style="width: 949px;" class="thead">
                <div style="width: 350px; padding-left: 20px;" class="th">Параметр</div>
                <div style="padding-left: 20px; border-right: none" class="th">Информация</div>
            </div>
            <div style="width: 951px;" class="tline"></div>
            @foreach (var factor in Model.Factors.Where(p => p.Value.IsUnconditional == false))
            {
                <div id="tbla@(i)" class="srclist_tbl" onclick="StopLight.switch_rating_info(this);StopLight.show_rating_info('a@(i)');" style="">
                    <div class="tabtr" style="width: 350px; padding-left: 20px;">
                        @if (factor.Value.IsStoped)
                        {
                            <span class="title">
                                <em style="font-weight:normal;">@factor.Value.Info</em>
                                <span class="icon-attention-circled yellow_attention"></span>
                            </span>
                        }
                        @factor.Value.Name
                    </div>
                    <div class="tabtr" style="width: 400px; padding-left: 20px;">@factor.Value.Info</div>
                    <div class="tabtr">
                        @if (StopLightUtilites.HasInfo(Model, factor.Key))
                        {
                            <span class="icon-angle-down" style="cursor: pointer">Подробнее</span>
                        }
                    </div>
                </div>
                if (StopLightUtilites.HasInfo(Model, factor.Key))
                {
                    <div id="tbla@(i)_info" class="sub_srclist_tbl" style="display: none;">
                        @Html.Action("ShowInfo", new
                {
                    data = Model,
                    factor = factor.Key

                })
                    </div>
                }
                i++;
            }
            <div class="explain" style="clear:both;padding-top:10px; ">ВНИМАНИЕ: в связи с особенностями функционирования и обновления указанного источника информации АО "СКРИН" не может гарантировать абсолютную актуальность и достоверность данных.</div>
        </div>
    </div>
}


