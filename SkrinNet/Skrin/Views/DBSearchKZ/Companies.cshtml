
@using Skrin.BLL.Infrastructure
@using Skrin.BLL.Authorization
@using Skrin.BLL.Root
@using Newtonsoft.Json


@{
    UserSession us = Context.GetUserSession();
    string add_tag = us.AuthenticationResult == AuthenticationType.Ok ? "" : " readonly=\"readonly\" onclick=\"united_login(5);\" ";
    int user_id = us.UserId;
}


@section Css{
    <link href="~/Content/search.css" rel="stylesheet" />
    <link href="~/Content/tree.css" rel="stylesheet" />
    <link href="~/Scripts/jquery-ui-1.11.4.custom/jquery-ui.min.css" rel="stylesheet" />
    <link href="~/Scripts/jquery-ui-1.11.4.custom/jquery-ui.theme.min.css" rel="stylesheet" />
    <link href="~/Scripts/jquery-ui-1.11.4.custom/jquery.ui.datepicker.css" rel="stylesheet" />
}

@section Script{
    <script src="~/Scripts/progs2.js"></script>
    <script src="~/Scripts/search/companiesKZ.js"></script>

    <script>
        var extGroupList =  @Html.Raw(JsonConvert.SerializeObject(AuthenticateSqlUtilites.GetExtGroupList(user_id)));
        var user_id=@(user_id);

        var roles_object=@Html.Raw(ViewBag.RolesJson);
    </script>
    <iframe class="service_frame" name="xls_frame" id="xls_frame" onload="hideClock();"></iframe>
}

<div id="search_block">
    <div id="search_block_base">
        <div class="content">
            <div id="base_block">
                <input class="search_input large" id="comp" placeholder="Наименование, ОКПО, РНН, БИН" />
                <button class="btns darkblue large" onclick="doSearch()">Найти</button>
                <button class="btns grey large" onclick="doClear()">Очистить</button>
                <h3 id="extended_switcher"><span id="extended_switcher_inner">Расширенный поиск</span><span id="switcher_ico" class="icon-angle-down"></span></h3>
            </div>
        </div>
    </div>

    <div id="search_block_extended">
        <div class="content">
            <div id="extended_block">
                <div class="form-group">
                    <label for="ruler" class="label_form">Руководитель</label>
                    <div class="sub_form">
                        <input id="ruler" type="text" class="search_input" placeholder="Руководитель" data-check />
                    </div>
                </div>        
                <div class="form-group">
                    <label for="econ" class="label_form">Сектор экономики</label>
                    <div class="sub_form">
                        <input id="econ" type="text" class="search_input" onclick="show_tree_selector(event,28,1)" placeholder="Сектор экономики" title="" />
                    </div>
                    <input type="hidden" id="econ_val" value="" data-check /><input type="hidden" id="econ_excl" value="0" />
                </div>
                <div class="form-group">
                    <label for="stat" class="label_form">Статус</label>
                    <div class="sub_form">
                        <input id="stat" type="text" class="search_input" onclick="show_tree_selector(event,26,1)" placeholder="Статус" title="Статус предприятия" />
                    </div>
                    <input type="hidden" id="stat_val" value="" data-check /><input type="hidden" id="stat_excl" value="0" />
                </div>
                <div class="form-group">
                    <label for="own" class="label_form">Вид собственности</label>
                    <div class="sub_form">
                        <input id="own" type="text" class="search_input" onclick="show_tree_selector(event,27,1)" placeholder="Вид собственности" title="Наименование вида собственности" />
                    </div>
                    <input type="hidden" id="own_val" value="" data-check /><input type="hidden" id="own_excl" value="0" />
                </div>
                <div class="form-group">
                    <label for="pcount" class="label_form">Численность</label>
                    <div class="sub_form">
                        <input id="pcount" type="text" class="search_input" onclick="show_tree_selector(event,29,1)" placeholder="Численность" title="Численность" />
                    </div>
                    <input type="hidden" id="pcount_val" value="" data-check /><input type="hidden" id="pcount_excl" value="0" />
                </div>
                <div class="form-group">
                    <label for="reg" class="label_form">Регион</label>
                    <div class="sub_form">
                        <input id="reg" type="text" class="search_input" onclick="show_tree_selector(event,31,1,0)" placeholder="Регион" title="Классификатор административно-территориальных объектов (КАТО)" />
                    </div>
                    <input type="hidden" id="reg_val" data-check value="" /><input type="hidden" id="reg_excl" value="0" />
                </div>

                <div class="form-group">
                    <label for="siz" class="label_form">Размерность предприятия</label>
                    <div class="sub_form">
                        <input id="siz" type="text" class="search_input" onclick="show_tree_selector(event,30,1)" placeholder="Размерность предприятия" title="" />
                    </div>
                    <input type="hidden" id="siz_val" value="" data-check /><input type="hidden" id="siz_excl" value="0" />
                </div>
                <div class="form-group">
                    <label for="ind" class="label_form">Отрасль</label>
                    <div class="sub_form">
                        <input id="ind" type="text" class="search_input" onclick="show_tree_selector(event,ind_type,1,1)" placeholder="Отрасль (ОКВЭД)" title="Общероссийский классификатор видов экономической деятельности" />
                        <div class="form_switcher">
                            <input type="radio" value="32" checked="checked" name="ind_type" prop="" onclick="ch_ind_type(this)" />ОКЭД
                            <input type="radio" value="32" name="ind_type" prop="IsMain" onclick="ch_ind_type(this)" />ОКЭД (основной)
                        </div>
                        <input type="hidden" id="ind_val" data-check value="" /><input type="hidden" id="ind_excl" value="0" />
                    </div>
                </div>

                <div class="form-group">
                    <label for="countVal" class="label_form">Выводить по</label>
                    <div class="sub_form">
                        <div class="customSelect" id="countSelect" onclick="show_countSelector();">
                            <span id="countVal" class="customVal" val="30">30</span>
                            <span class="icon-angle-down"></span>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <button class="btns darkblue large" onclick="doSearch()">Найти</button>
                    <button class="btns grey large" onclick="doClear()">Очистить</button>
                </div>

            </div>
        </div>
    </div>
</div>

<div id="result_block">
    <div class="content">
        <div id="search_result" style="display:none;">
        </div>
        <div style="clear:both"></div>
    </div>
</div>
